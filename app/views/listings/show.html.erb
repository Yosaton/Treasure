<%# <h3> My Current Listings: </h3> %>


<h1> <%=@listing.title%> </h1>
<h2> Price: <%=@listing.price%> ringits/day </h2>
<h2> Item owner: <%=@listing.user.first_name%> </h2>
<h2> Area: <%=@listing.place%> </h2>

    <% provide :head_tags do %>
        <meta name='turbolinks-visit-control' content='reload'>
            <script>
            document.addEventListener("DOMContentLoaded", function(){
                initMap(<%=@listing.latitude%>, <%=@listing.longitude%>)
            });
            </script>
    <% end %>



    <% provide :head_tags do %>
        <%# So that the JS function runs when the page is loaded %>
        <meta name='turbolinks-visit-control' content='reload'>
            <script>
                document.addEventListener("DOMContentLoaded", initMap2);
            </script>
    <% end %>




<div class= "card-deck" style= "display:flex; justify-content: space-betweem">
        <div class = "d-inline-block">
            <div class="card border-dark mb-4 mr-2" style="width: 18rem;">
                <div class="card-body">

                    <div class="card-text">
                    
                        <div id="<%='carouselExampleControls' + @listing.id.to_s%>" class="carousel slide" data-ride="carousel">
                            <div class="carousel-inner">
                                <% if @listing.images.present?%>                   
                                    <% @listing.images.each_with_index do |pic, i| %>
                                        
                                        <% if i == 0 %>
                                            <%# image class = image tag %>
                                            <div class="carousel-item active">
                                                <img class="d-block w-100" src="<%=pic.url %>" alt="First slide">
                                            </div>
                                        <%else%>
                                            <%# image_tag and url are built in helpers %>
                                            <%# <%= image_tag l.images_url.to_s %> 
                                            <div class="carousel-item">
                                                <img class="d-block w-100" src="<%=pic.url %>" alt="Second slide">
                                            </div>
                                        <%end%>
                                    <%end%>
                                <%end%>
                            </div>

                            <a class="carousel-control-prev" href="<%='#carouselExampleControls' + @listing.id.to_s%>" role="button" data-slide="prev">
                                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                                <span class="sr-only">Previous</span>
                            </a>
                            <a class="carousel-control-next" href="<%='#carouselExampleControls' + @listing.id.to_s%>" role="button" data-slide="next">
                                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                                <span class="sr-only">Next</span>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
</div>


<p>
    <div id="map"></div>
</p>


<script>

function initMap(lat, lng) {
    var myCoords = new google.maps.LatLng(lat, lng);
    var mapOptions = {
    center: myCoords,
    zoom: 14
    };
    var map = new google.maps.Map(document.getElementById('map'), mapOptions);

    // marker
    var marker = new google.maps.Marker({
    position: myCoords,
    map: map
});
}

</script>